-- Создание таблиц для системы проверок
CREATE TABLE IF NOT EXISTS player_inspectors (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER NOT NULL,
    level INTEGER NOT NULL,
    bought_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UNIQUE(user_id, level)
);

CREATE TABLE IF NOT EXISTS player_protections (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER NOT NULL,
    level INTEGER NOT NULL,
    bought_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UNIQUE(user_id, level)
);

CREATE TABLE IF NOT EXISTS active_protections (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER NOT NULL UNIQUE,
    protection_level INTEGER NOT NULL,
    activated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    expires_at TIMESTAMP NOT NULL
);

CREATE TABLE IF NOT EXISTS inspection_stats (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER NOT NULL UNIQUE,
    total_inspections INTEGER DEFAULT 0,
    successful_inspections INTEGER DEFAULT 0,
    failed_inspections INTEGER DEFAULT 0,
    halls_closed INTEGER DEFAULT 0,
    inspections_today INTEGER DEFAULT 0,
    last_inspection TIMESTAMP,
    last_reset_date DATE DEFAULT CURRENT_DATE
);

CREATE TABLE IF NOT EXISTS protection_stats (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER NOT NULL UNIQUE,
    total_blocked INTEGER DEFAULT 0,
    total_spent_on_protection INTEGER DEFAULT 0
);

CREATE TABLE IF NOT EXISTS inspection_time_mode (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    is_active BOOLEAN DEFAULT 0,
    started_at TIMESTAMP,
    ends_at TIMESTAMP
);
